<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Poona Panjarpole Trust</title>

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="mobile.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Hind:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <div id="site-fadein-overlay">
    <span class="fadein-namaste">NAMASTE</span>
  </div>

  <a href="upi://pay?pa=Mswipe.1400041924000711@kotak&pn=PoonaPanjarpoleTrust&cu=INR&tn=Donation" class="donate-sidebar" data-i18n="donate_now">Donate Now</a>
  <a href="#" class="callnow-sidebar" id="callNowBtn"><img src="media/telephone.png" alt="Call Now" style="width:96px;height:96px;object-fit:contain;display:block;margin:0 auto;"> </a>
  
  <header>
    <div class="header-content">
      <div class="title-row">
        <button class="hamburger-menu" aria-label="Toggle navigation menu">
          <span></span>
          <span></span>
          <span></span>
        </button>
        <img src="media/elephant1.png" alt="Elephant Left" class="elephant-image">
        <h1 data-i18n="title" class="site-title">Poona Panjarpole Trust</h1>
        <img src="media/elephant2.png" alt="Elephant Right" class="elephant-image">
        <div class="lang-container">
          <select id="languageSwitcher">
            <option value="en">English</option>
            <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
            <option value="mr">‡§Æ‡§∞‡§æ‡§†‡•Ä</option>
          </select>
        </div>
      </div>
    </div>
  </header>

  <header class="second-header">
    <div class="header-content">
      <div class="title-row">
        <nav class="main-nav">
          <a href="index.html"><span class="nav-icon">üè†</span> <span data-i18n="nav_home">Home</span></a>
          <a href="index.html#about"><span class="nav-icon">üë§</span> <span data-i18n="nav_about">About Us</span></a>
          <a href="index.html#mission"><span class="nav-icon">üéØ</span> <span data-i18n="nav_mission">Our Mission</span></a>
          <a href="index.html#gallery"><span class="nav-icon">üñºÔ∏è</span> <span data-i18n="nav_gallery">Gallery</span></a>
          <a href="index.html#products"><span class="nav-icon">üõí</span> <span data-i18n="nav_products">Products for Sale</span></a>
          <a href="index.html#gau-chalisha"><span class="nav-icon">üêÆ</span> <span data-i18n="nav_gau_chalisha">Gau Chalisa</span></a>
          <a href="cow-blessings.html"><span class="nav-icon">üêÑ</span> <span data-i18n="nav_cow_blessings">Cow Blessings</span></a>
          <a href="index.html#donate"><span class="nav-icon">üíù</span> <span data-i18n="nav_support">Support Us</span></a>
          <a href="index.html#volunteer"><span class="nav-icon">ü§ù</span> <span data-i18n="nav_volunteer">Volunteer</span></a>
          <a href="index.html#contact"><span class="nav-icon">üìû</span> <span data-i18n="nav_contact">Contact Us</span></a>
          <a href="index.html#satellite_view"><span class="nav-icon">üåê</span> <span data-i18n="nav_satellite">3D Satellite View</span></a>
          <a href="blogs.html" class="active"><span class="nav-icon">üì∞</span> <span data-i18n="nav_blogs">Blogs</span></a>
        </nav>
      </div>
    </div>
  </header>

<main id="main-content">
  <section>
    <div class="blogs-section-title">
      <span class="blogs-title-icon">üì∞</span>
      <h2 data-i18n="blogs_title" class="blogs-title-main">Blogs</h2>
      <div class="blogs-title-sub" data-i18n="blogs_subtitle">Stories, Wisdom & Inspiration from the Panjarpol</div>
      <div class="blogs-title-divider"></div>
    </div>
    <div class="blogs-cards" id="blogs-cards">
      <!-- Blog cards will be injected here by JS for i18n support -->
    </div>
  </section>
</main>

<button id="scrollToTop" class="scroll-to-top" aria-label="Scroll to top">‚Üë</button>

<footer>
  <div class="footer-social">
    <a href="https://www.facebook.com/share/1ATGtWdcEq/" target="_blank" class="social-link" aria-label="Facebook">
      <i class="fab fa-facebook-f"></i>
      <span>Facebook</span>
    </a>
    <a href="https://www.instagram.com/punepanjarpoltrust?igsh=MXY4bmR2cnd2ajhuaQ==" target="_blank" class="social-link" aria-label="Instagram">
      <i class="fab fa-instagram"></i>
      <span>Instagram</span>
    </a>
    <a href="https://www.youtube.com/channel/UCVQvVUUyKscxYt8Ynn_zbLA" target="_blank" class="social-link" aria-label="YouTube">
      <i class="fab fa-youtube"></i>
      <span>YouTube</span>
    </a>
  </div>
  <p data-i18n="footer">¬© 2025 Poona Panjarpole Trust. All Rights Reserved.</p>
</footer>

<!-- Chatbot Widget -->
<div id="narayan-chatbot">
  <button id="narayan-chatbot-btn" aria-label="Open chat with NAARAD">
    <img src="media/narad-removebg-preview.png" alt="NAARAD" class="chatbot-icon">
  </button>
  <div id="narayan-chatbot-window" class="closed">
    <div class="narayan-header">NAARAD <span class="narayan-status">‚óè online</span></div>
    <div id="narayan-chat-messages" class="narayan-messages">
    </div>
  </div>
  <div class="chat-popup">Chat with NAARAD</div>
</div>

<!-- Modal for desktop call info -->
<div id="callNowModal" class="callnow-modal" style="display:none;">
  <div class="callnow-modal-content">
    <span class="callnow-modal-close">&times;</span>
    <p>Call us at <strong>8999158881</strong></p>
  </div>
</div>

<!-- Modal Blur Background -->
<div id="donate-modal-blur"></div>
<!-- Modal Window -->
<div id="donate-modal">
  <button class="close-btn" id="donate-modal-close" title="Close">&times;</button>
  <div class="donate-modal-tabs">
    <div class="donate-modal-tab active" id="donate-tab-upi">UPI</div>
    <div class="donate-modal-tab" id="donate-tab-netbanking">Netbanking</div>
  </div>
  <div class="donate-modal-content donate-modal-upi active" id="donate-content-upi">
    <img src="media/qr-code_final.jpg" alt="UPI QR Code for Donation" />
    <div style="font-size:1.1em;margin-bottom:0.5em;">UPI ID: <b>Mswipe.1400041924000711@kotak</b></div>
    <div style="font-size:0.95em;color:#b8860b;">Scan the QR code or use the UPI ID in your payment app.</div>
  </div>
  <div class="donate-modal-content donate-modal-netbanking" id="donate-content-netbanking">
    <div style="font-size:1.1em;margin-bottom:0.5em;"><b>Bank Details:</b></div>
    <div style="text-align:left;display:inline-block;line-height:1.7;font-size:1em;">
      <b>Account Name:</b> Poona Panjarpole Trust<br>
      <b>Bank Name:</b> DCB Bank<br>
      <b>Branch:</b> DP Road Pune<br>
      <b>A/C No:</b> 01413600000125<br>
      <b>IFSC:</b> DCBL0000014<br>
      <b>UPI ID:</b> Mswipe.1400041924000711@kotak
    </div>
  </div>
  <a href="https://docs.google.com/forms/d/e/1FAIpQLScegVommazp9BBatggeCktJk1xtMdp4V2xGyKK85eTjnSOXaQ/viewform?usp=dialog" id="donate-modal-form-btn" class="donate-modal-form-btn" data-i18n="donate_form_btn" target="_blank" style="margin-top:0.7em;background:linear-gradient(135deg,#ffd98c 0%,#ffcc66 100%);color:#6b3e00;border:2px solid #b8860b;border-radius:8px;padding:0.4em 1.2em;font-size:0.98em;font-weight:600;cursor:pointer;transition:background 0.2s;display:inline-block;">Fill this form after the payment for receipt</a>
</div>

<style>
  #main-content {
    opacity: 0;
  }
</style>

<script src="lang.js"></script>
<script src="js/chatgpt-service.js"></script>
<script src="chatbot.js"></script>
<script>
let blogsJsonData = [];

function getCurrentLanguage() {
  // Use the dropdown if present, else localStorage, else default to 'en'
  const switcher = document.getElementById('languageSwitcher');
  if (switcher && switcher.value) return switcher.value;
  return localStorage.getItem('selectedLanguage') || 'en';
}

function setCurrentLanguage(lang) {
  localStorage.setItem('selectedLanguage', lang);
  const switcher = document.getElementById('languageSwitcher');
  if (switcher) switcher.value = lang;
}

// Helper: Get unique blog key for localStorage
function getBlogKey(blogId) {
  return `blog_${blogId}_${getCurrentLanguage()}`;
}

// Fetch blogs.json and store globally
async function fetchBlogsJson() {
  try {
    const res = await fetch('blogs.json');
    blogsJsonData = await res.json();
    renderBlogs(getCurrentLanguage());
  } catch (e) {
    document.getElementById('blogs-cards').innerHTML = '<p>Could not load blogs.</p>';
  }
}

function renderBlogs(lang) {
  const container = document.getElementById('blogs-cards');
  container.innerHTML = '';
  if (!blogsJsonData.length) return;
  blogsJsonData.forEach(blog => {
    const blogKey = getBlogKey(blog.id);
    // Likes
    let likes = parseInt(localStorage.getItem(blogKey + '_likes') || '0');
    // Comments
    let comments = [];
    try {
      comments = JSON.parse(localStorage.getItem(blogKey + '_comments')) || [];
    } catch { comments = []; }
    // Card
    const card = document.createElement('div');
    card.className = 'blog-card';
    card.innerHTML = `
      <h3 class="blog-title"><span class="blog-icon">${blog.icon}</span> ${blog.title[lang] || blog.title['en']}</h3>
      <p class="blog-content">${blog.content[lang] || blog.content['en']}</p>
      <div class="blog-actions">
        <button class="like-btn" data-id="${blog.id}">üëç <span class="like-count">${likes}</span></button>
        <button class="comment-btn" data-id="${blog.id}">üí¨ Comment</button>
        <button class="share-btn" data-id="${blog.id}">üîó Share</button>
      </div>
      <div class="blog-comments" id="comments-${blog.id}" style="display:none;"></div>
    `;
    container.appendChild(card);
    // Like/Unlike button event
    const likeBtn = card.querySelector('.like-btn');
    let likedFlag = localStorage.getItem(blogKey + '_liked') === '1';
    function updateLikeBtn() {
      if (likedFlag) {
        likeBtn.textContent = `üëé Unlike${likes > 0 ? ' (' + likes + ')' : ''}`;
        likeBtn.disabled = false;
        likeBtn.style.opacity = '1';
      } else {
        likeBtn.textContent = `üëç Like`;
        likeBtn.disabled = false;
        likeBtn.style.opacity = '1';
      }
    }
    updateLikeBtn();
    likeBtn.onclick = function() {
      likedFlag = localStorage.getItem(blogKey + '_liked') === '1';
      if (!likedFlag) {
        likes = 1;
        localStorage.setItem(blogKey + '_likes', likes);
        localStorage.setItem(blogKey + '_liked', '1');
        likedFlag = true;
      } else {
        likes = 0;
        localStorage.removeItem(blogKey + '_likes');
        localStorage.removeItem(blogKey + '_liked');
        likedFlag = false;
      }
      updateLikeBtn();
    };
    // Comment button event
    card.querySelector('.comment-btn').onclick = function() {
      const commentsDiv = card.querySelector(`#comments-${blog.id}`);
      if (commentsDiv.style.display === 'none') {
        showComments(blog, commentsDiv, comments, blogKey);
        commentsDiv.style.display = 'block';
      } else {
        commentsDiv.style.display = 'none';
      }
    };
    // Share button event
    card.querySelector('.share-btn').onclick = function() {
      const shareUrl = window.location.origin + window.location.pathname + `#blog-${blog.id}`;
      if (navigator.share) {
        navigator.share({
          title: blog.title[lang] || blog.title['en'],
          text: blog.content[lang] || blog.content['en'],
          url: shareUrl
        });
      } else {
        navigator.clipboard.writeText(shareUrl);
        this.textContent = '‚úÖ Copied!';
        setTimeout(() => { this.textContent = 'üîó Share'; }, 1200);
      }
    };
    // Add anchor for direct link
    card.id = `blog-${blog.id}`;
  });
}

function showComments(blog, commentsDiv, comments, blogKey) {
  commentsDiv.innerHTML = '';
  // List comments
  if (comments.length) {
    comments.forEach(c => {
      const cDiv = document.createElement('div');
      cDiv.className = 'blog-comment';
      cDiv.textContent = c;
      commentsDiv.appendChild(cDiv);
    });
  } else {
    commentsDiv.innerHTML = '<div style="color:#bfa14a;">No comments yet.</div>';
  }
  // Add comment form
  const form = document.createElement('form');
  form.className = 'blog-comment-form';
  form.innerHTML = `<input type="text" placeholder="Add a comment..." maxlength="200" required><button type="submit">Post</button>`;
  form.onsubmit = function(e) {
    e.preventDefault();
    const val = form.querySelector('input').value.trim();
    if (val) {
      comments.push(val);
      localStorage.setItem(blogKey + '_comments', JSON.stringify(comments));
      showComments(blog, commentsDiv, comments, blogKey);
    }
    form.reset();
  };
  commentsDiv.appendChild(form);
}

function setupBlogsI18n() {
  const switcher = document.getElementById('languageSwitcher');
  // Use localStorage or dropdown value, default to 'en'
  let blogsLang = localStorage.getItem('selectedLanguage') || (switcher && switcher.value) || 'en';
  if (switcher) {
    switcher.value = blogsLang;
    switcher.addEventListener('change', e => {
      blogsLang = e.target.value;
      setCurrentLanguage(blogsLang);
      renderBlogs(blogsLang);
      if (typeof loadTranslations === 'function') loadTranslations(blogsLang);
    });
  }
  setCurrentLanguage(blogsLang);
  if (typeof loadTranslations === 'function') loadTranslations(blogsLang);
  fetchBlogsJson();
}
document.addEventListener('DOMContentLoaded', setupBlogsI18n);

document.addEventListener('DOMContentLoaded', function() {
  // Smooth fade-in for main content
  const main = document.getElementById('main-content');
  if (main) {
    main.classList.add('animate__animated', 'animate__fadeIn');
    main.style.setProperty('--animate-duration', '1.1s');
    main.style.opacity = 1;
  }

  // Hamburger menu functionality
  const hamburger = document.querySelector('.hamburger-menu');
  const mainNav = document.querySelector('.main-nav');
  const body = document.body;

  function toggleMenu() {
    mainNav.classList.toggle('active');
    if (mainNav.classList.contains('active')) {
      body.style.overflow = 'hidden';
    } else {
      body.style.overflow = '';
    }
  }

  hamburger.addEventListener('click', toggleMenu);

  // Close menu when clicking the X button or a nav link
  mainNav.addEventListener('click', function(e) {
    if (e.target === this || e.target.tagName === 'A') {
      mainNav.classList.remove('active');
      body.style.overflow = '';
    }
  });

  // Call Now button functionality
  const callNowBtn = document.getElementById('callNowBtn');
  const callNowModal = document.getElementById('callNowModal');
  const callNowModalClose = document.querySelector('.callnow-modal-close');
  function isMobileDevice() {
    return /Mobi|Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent);
  }
  callNowBtn.addEventListener('click', function(e) {
    if (isMobileDevice()) {
      window.location.href = 'tel:8999158881';
    } else {
      e.preventDefault();
      callNowModal.style.display = 'block';
    }
  });
  if (callNowModalClose) {
    callNowModalClose.onclick = function() {
      callNowModal.style.display = 'none';
    };
  }
  window.onclick = function(event) {
    if (event.target === callNowModal) {
      callNowModal.style.display = 'none';
    }
  };

  // Force English as default on blogs page
  var langSwitcher = document.getElementById('languageSwitcher');
  if (langSwitcher) langSwitcher.value = 'en';
  if (typeof loadTranslations === 'function') loadTranslations('en');

  var switcher = document.getElementById('languageSwitcher');
  var savedLang = sessionStorage.getItem('selectedLanguage') || 'en';
  if (switcher) switcher.value = savedLang;
  if (typeof loadTranslations === 'function') loadTranslations(savedLang);
  if (typeof renderBlogs === 'function') renderBlogs(savedLang);
  if (switcher) {
    switcher.addEventListener('change', function() {
      var lang = this.value;
      sessionStorage.setItem('selectedLanguage', lang);
      if (typeof loadTranslations === 'function') loadTranslations(lang);
      if (typeof renderBlogs === 'function') renderBlogs(lang);
    });
  }
});

// Donate Modal Logic for both sidebar and main donate buttons
(function() {
  const donateBtn = document.getElementById('donate-modal-btn');
  const donateSidebarBtn = document.querySelector('.donate-sidebar');
  const modal = document.getElementById('donate-modal');
  const blur = document.getElementById('donate-modal-blur');
  const closeBtn = document.getElementById('donate-modal-close');
  const tabUPI = document.getElementById('donate-tab-upi');
  const tabNet = document.getElementById('donate-tab-netbanking');
  const contentUPI = document.getElementById('donate-content-upi');
  const contentNet = document.getElementById('donate-content-netbanking');
  const formBtn = document.getElementById('donate-modal-form-btn');

  function openModal(e) {
    if (e) e.preventDefault();
    modal.style.display = 'block';
    blur.style.display = 'block';
    document.body.style.overflow = 'hidden';
  }
  function closeModal() {
    modal.style.display = 'none';
    blur.style.display = 'none';
    document.body.style.overflow = '';
  }
  if (donateBtn) donateBtn.onclick = openModal;
  if (donateSidebarBtn) donateSidebarBtn.onclick = openModal;
  if (closeBtn) closeBtn.onclick = closeModal;
  if (blur) blur.onclick = closeModal;
  // Tab switching
  if (tabUPI && tabNet && contentUPI && contentNet) {
    tabUPI.onclick = function() {
      tabUPI.classList.add('active');
      tabNet.classList.remove('active');
      contentUPI.classList.add('active');
      contentNet.classList.remove('active');
    };
    tabNet.onclick = function() {
      tabNet.classList.add('active');
      tabUPI.classList.remove('active');
      contentNet.classList.add('active');
      contentUPI.classList.remove('active');
    };
  }
  // Form button (replace # with your form link)
  if (formBtn) formBtn.href = 'https://docs.google.com/forms/d/e/1FAIpQLScegVommazp9BBatggeCktJk1xtMdp4V2xGyKK85eTjnSOXaQ/viewform?usp=dialog';
})();

// Redirect to home page if this is the first page in the session
(function() {
  if (!sessionStorage.getItem('hasVisitedAnyPage')) {
    sessionStorage.setItem('hasVisitedAnyPage', 'true');
    window.location.href = 'index.html';
  }
})();
</script>
</body>
</html> 
